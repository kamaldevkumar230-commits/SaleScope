<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>My Profile | SaleScope</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

<style>
body {
    background: linear-gradient(135deg,#0f2027,#203a43,#2c5364);
    font-family: "Poppins", sans-serif;
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
}

.profile-card {
    background: rgba(255,255,255,0.08);
    backdrop-filter: blur(15px);
    border-radius: 20px;
    width: 420px;
    padding: 35px;
    text-align: center;
    box-shadow: 0 10px 30px rgba(0,0,0,0.4);
    color: white;
}

.profile-img-wrapper {
    position: relative;
    display: inline-block;
}

.profile-img {
    width: 140px;
    height: 140px;
    border-radius: 50%;
    object-fit: cover;
    border: 4px solid #ffd369;
    transition: 0.3s;
}

.profile-img:hover {
    transform: scale(1.05);
}

.camera-icon {
    position: absolute;
    bottom: 10px;
    right: 10px;
    background: #ffd369;
    color: black;
    border-radius: 50%;
    padding: 6px 8px;
    font-size: 14px;
    cursor: pointer;
}

.info-box {
    text-align: left;
    margin-top: 25px;
}

.info-box strong {
    color: #ffd369;
}

.btn-home {
    background: #ffd369;
    border: none;
    color: black;
    font-weight: 600;
    border-radius: 8px;
}

.btn-home:hover {
    background: #ffca2c;
}

input[type="file"] {
    display: none;
}
</style>
</head>
<body>

<div class="profile-card" th:if="${currentUser != null}">

    <!-- Profile Image -->
    <div class="profile-img-wrapper">

		<img th:if="${currentUser.profileImage != null and !currentUser.profileImage.isEmpty()}"
		     th:src="${currentUser.profileImage}"
		     class="profile-img">

		<img th:if="${currentUser.profileImage == null or currentUser.profileImage.isEmpty()}"
		     th:src="@{/images/user.png}"
		     class="profile-img">
        <i class="fa fa-camera camera-icon" onclick="triggerUpload()"></i>
    </div>

    <!-- Upload Form -->
   <form th:action="@{/customerprofile}" method="post" enctype="multipart/form-data">
        <input type="file" id="fileInput" name="profileImage" accept="image/*"
               onchange="this.form.submit()">
    </form>

    <!-- Name & Role -->
    <h4 class="mt-3 fw-bold" th:text="${currentUser.name}">User Name</h4>
    <p class="text-warning" th:text="${currentUser.role}">Role</p>

    <hr>

    <!-- Info -->
    <div class="info-box">
        <p><strong>Email:</strong> <span th:text="${currentUser.email}"></span></p>
        <p><strong>User ID:</strong> <span th:text="${currentUser.id}"></span></p>
    </div>

    <a th:href="@{/customer/dashboard}" class="btn btn-home mt-3 px-4">
        ← Back to Dashboard
    </a>

</div>

<!-- Session Expired -->
<div class="profile-card text-center" th:if="${currentUser == null}">
    <h4>⚠ Session Expired</h4>
    <a th:href="@{/login}" class="btn btn-home mt-3">Login Again</a>
</div>

<script>
function triggerUpload() {
    document.getElementById("fileInput").click();
}
</script>

</body>
</html>